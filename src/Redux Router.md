---
title: –õ–µ–∫—Ü–∏–∏ –ø–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É - Redux Router
---

## Redux Router

![redux router](assets/redux-router/router-meme.png)

[–î–º–∏—Ç—Ä–∏–π –í–∞–π–Ω–µ—Ä](https://github.com/dmitryweiner)

---

### –ò–¥–µ—è
* –ù—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –æ–¥–Ω–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏.
* –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ –¥–æ–ª–∂–Ω–∞ –º–µ–Ω—è—Ç—å—Å—è –∞–¥—Ä–µ—Å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞.
* –ï—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Redux, –º–æ–∂–Ω–æ —Å–ø–æ–∫–æ–π–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [react-router-dom](https://dmitryweiner.github.io/lectures/React%20Router.html#/).
* –ù–∞–¥–æ –ø–æ–¥—Ä—É–∂–∏—Ç—å —Ä–æ—É—Ç–µ—Ä –∏ Redux, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –º–µ–Ω—è—Ç—å —Ä–æ—É—Ç—ã –Ω–µ —Ç–æ–ª—å–∫–æ –∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –Ω–æ –∏ –∏–∑ —ç–∫—à–µ–Ω–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç.
* –î–ª—è —ç—Ç–æ–≥–æ —Ä–æ—É—Ç –∏ –∏—Å—Ç–æ—Ä–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Å—Ç–æ—Ä–µ!

---

### –í—ã–±–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
* –†–∞–Ω—å—à–µ –±—ã —è –ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–ª [react-router-redux](https://github.com/reactjs/react-router-redux).
* –ù–æ –µ—ë —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ–∫—Ä–∞—â–µ–Ω–∞ –≤ 2018 –≥–æ–¥—É.
* –ê–≤—Ç–æ—Ä —Å–æ–≤–µ—Ç—É–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ [connected-react-router](https://github.com/supasate/connected-react-router).
* –ï—ë –∏ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.
* [–≠—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è](https://github.com/markerikson/redux-ecosystem-links/blob/master/routing.md).

---

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: –ø–µ—Ä–≤—ã–π —ç—Ç–∞–ø
* –£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```shell
npm i connected-react-router
npm i -D @types/history # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö TS
```
* –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ ```history```:

```js
// –¥–ª—è standalone —Ö–æ—Å—Ç–∏–Ω–≥–∞
import { createBrowserHistory } from 'history';
// –¥–ª—è —Ö–æ—Å—Ç–∏–Ω–≥–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
import { createHashHistory } from 'history';
const history = createBrowserHistory();
```

---

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: –≤—Ç–æ—Ä–æ–π —ç—Ç–∞–ø
* –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–æ—Ä–∞:

```js
import { combineReducers, createStore, applyMiddleware } from 'redux';
import { connectRouter, routerMiddleware } from 'connected-react-router';
const store = createStore(
    combineReducers({
        router: connectRouter(history), // –∫–ª—é—á –æ–±—ä–µ–∫—Ç–∞ —Ç–æ–ª—å–∫–æ "router", –Ω–µ –∏–Ω–∞—á–µ
        ... // rest of your reducers
    }),
    applyMiddleware(
        routerMiddleware(history), // for dispatching history actions
        // ... other middlewares ...
    )
);
```

---

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: —Ç—Ä–µ—Ç–∏–π —ç—Ç–∞–ø
* –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º ```<App>``` –≤ ```<ConnectedRouter>```:
```js
import { ConnectedRouter } from 'connected-react-router';
ReactDOM.render(
    <Provider store={store}>
        <ConnectedRouter history={history}>
            <App />
        </ConnectedRouter>
    </Provider>,
    document.getElementById('root')
);
```

---

### Switch
* –í–Ω—É—Ç—Ä–∏ ```<App>``` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ```<Switch>```, –≤ –∫–æ—Ç–æ—Ä–æ–º –ª–µ–∂–∞—Ç –Ω—É–∂–Ω—ã–µ —Ä–æ—É—Ç—ã.
* [–û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è c —Ä–∞–±–æ—Ç–æ–π Route, Switch](https://dmitryweiner.github.io/lectures/React%20Router.html#/6).
```js
import { Route, Switch } from 'react-router';
//
<Switch>
    <Route exact path="/" render={() => (<div>Match</div>)} />
    <Route render={() => (<div>Miss</div>)} />
</Switch>
```
* –£—Å—Ç–∞–Ω–æ–≤–∫–∞:
```shell
npm i react-router react-router-dom
npm i -D @types/react-router @types/react-router-dom # –¥–ª—è TS
```

---

### –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ —Ä–æ—É—Ç–∞–º
* –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ:
```js
import { Link } from 'react-router-dom';
//
<Link to="/home">Home</Link>
```
* –ò–ª–∏ —Ç–∞–∫:
```js
import { push } from 'connected-react-router';
//
<div onClick={() => {
    push('/login');
}}>login</div>
```  

---

### –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ —Ä–æ—É—Ç—É –∏–∑ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ —ç–∫—à–µ–Ω–∞
```js
import { push } from 'connected-react-router'
//
export const login = (username, password) => (dispatch) => {
  /* do something before redirection */
  dispatch(push('/home'))
};
```

---

### –ü–µ—Ä–µ—Ö–æ–¥ –∏–∑ —Å–∞–≥–∏
```js
import { push } from 'connected-react-router'
import { put, call } from 'redux-saga/effects'
//
export function* login(username, password) {
  /* do something before redirection */
  yield put(push('/home'))
}
```

---

### –£–∑–Ω–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–æ—É—Ç–µ—Ä–∞
* –û–Ω–∏ –ª–µ–∂–∞—Ç –≤ —Å—Ç–æ—Ä–µ:
```js
state.router.location.pathname // —Ç–µ–∫—É—â–∏–π URL
state.router.location.search // –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å, —Ä–∞–∑–æ–±—Ä–∞–Ω–Ω—ã–π –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
state.router.location.hash // —Ç–æ, —á—Ç–æ –ø–æ—Å–ª–µ # –≤ URL
```
* –î–ª—è ```/hello?a=1#123```:
```js
location = {
    pathname: "/hello",
    search: "?a=1",
    hash: "#123",
    query: {
        a: "1"
    }
}
```

---

### –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ —Ä–æ—É—Ç–∞ ```route/:id```
* –í—Å—ë –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –∫–æ—Å—Ç—ã–ª–∏. 
  –ú–æ–∂–Ω–æ —Å—Ö–æ–¥–∏—Ç—å –ø–æ—Å—Ç–∞–≤–∏—Ç—å üëç –∑–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ 
  [issue](https://github.com/supasate/connected-react-router/issues/38).
* –ö–æ—Å—Ç—ã–ª—å –ø–æ–ª—É—á—à–µ:

```tsx
import { createMatchSelector } from 'connected-react-router';
import { useSelector } from 'react-redux';
const matchSelector = createMatchSelector<AppState, {id: string}>({ path: '/user/:id' });
function User() {
    const match = useSelector(matchSelector);
    return <>{match?.params.id}</>;
}
```

----

* –ö–æ—Å—Ç—ã–ª—å –ø–æ—Ö—É–∂–µ:

```tsx
import { matchPath } from 'react-router-dom';
import { useSelector } from 'react-redux';
function User() {
    const pathname = useSelector((state: AppState) => state.router.location.pathname);
    const match = matchPath<{id: string}>(
        pathname, // like: /user/123
        { path: '/user/:id' }
    );
    return <>{match?.params.id}</>;
}
```

---

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏
* [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://github.com/supasate/connected-react-router).
* [–ß–∞–í–æ](https://github.com/supasate/connected-react-router/blob/master/FAQ.md).
* [–ü—Ä–∏–º–µ—Ä—ã](https://github.com/supasate/connected-react-router/blob/master/examples).
* [–°–ø–∏—Å–æ–∫ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ä–æ—É—Ç–µ—Ä–æ–≤](https://github.com/markerikson/redux-ecosystem-links/blob/master/routing.md).
